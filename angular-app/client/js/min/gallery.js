function Gallery(e){var t=this;t.currentSlide={source:null,caption:null},t.construct=function(){t.startSlideshowFromHash(),t.bindEvents()},t.startSlideshowFromHash=function(){if(document.location.hash){var n=$(e.elements.thumbnailAnchor)[document.location.hash.slice(1)-1];n&&t.startSlideshow(n)}},t.bindEvents=function(){$(e.elements.thumbnailAnchor).click(function(e){t.startSlideshow(this),e.preventDefault()}),$(e.elements.previousAnchor).click(function(e){t.showPreviousSlide(),e.preventDefault()}),$(e.elements.nextAnchor).click(function(e){t.showNextSlide(),e.preventDefault()}),$(e.elements.closeAnchor).click(function(e){t.endSlideshow(),e.preventDefault()}),$(document).keydown(function(e){switch(e.which){case 13:t.startSlideshow(null);break;case 37:t.showPreviousSlide();break;case 39:t.showNextSlide();break;case 27:t.endSlideshow();break;default:return}})},t.startSlideshow=function(n){t.changeSlide(n),$(e.elements.slideshow).addClass("show-zoom")},t.changeSlide=function(n){null==n&&(n=$(e.elements.thumbnailAnchor).first()),t.currentSlide.source=$(n).attr("href"),t.currentSlide.caption=$(n).attr("title");var i=$("<img>").attr("src",t.currentSlide.source).attr("title",t.currentSlide.caption).attr("alt",t.currentSlide.caption);$(e.elements.currentImage).html(i),$(e.elements.currentCaption).html(t.currentSlide.caption),t.changeHash($('a[href="'+t.currentSlide.source+'"]').parent().index()+1)},t.changeHash=function(e){null==e?history.pushState("",document.title,window.location.pathname):document.location.hash=e},t.showPreviousSlide=function(){var n=$(e.elements.thumbnailAnchor+'[href="'+t.currentSlide.source+'"]'),i=n.parent().prev().children().first();0==$(i).length&&(i=n.parent().siblings().last().children().first()),t.changeSlide(i)},t.showNextSlide=function(){var n=$(e.elements.thumbnailAnchor+'[href="'+t.currentSlide.source+'"]'),i=n.parent().next().children().first();0==$(i).length&&(i=n.parent().siblings().first().children().first()),t.changeSlide(i)},t.endSlideshow=function(){$(e.elements.slideshow).removeClass("show-zoom"),t.changeHash(null)},t.construct()}